@layer components {
  .userbar {
    position: fixed;
    top: 8px;
    right: 10px;
    z-index: 15;
    display: flex;
    align-items: center;
    gap: var(--space-xs);
  }

  .userbar__user {
    display: inline-flex;
    align-items: center;
    align-self: flex-start;
    gap: var(--space-2xs);
    margin-left: auto;
  }

  .userbar__greeting {
    font-size: var(--font-size-s);
    color: var(--color-text-secondary);
    white-space: nowrap;
  }
  .userbar__greeting strong {
    color: var(--color-text-primary);
  }

  .userbar__avatar {
    width: 36px;
    height: 36px;
    border-radius: var(--radius-round);
    overflow: hidden;
    background: var(--color-bg-muted);
    display: grid;
    place-items: center;
    border: 1px solid var(--color-border-primary);
    box-shadow: var(--shadow-s);
    color: var(--color-text-secondary);
    transition:
      background-color var(--transition-base) var(--transition-easing-standard),
      color var(--transition-base) var(--transition-easing-standard),
      box-shadow var(--transition-base) var(--transition-easing-standard);
  }
  .userbar__avatar > img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .userbar__menu {
    position: relative;
  }
  .userbar__menu summary {
    list-style: none;
    outline: none;
    cursor: pointer;
  }
  .userbar__menu summary::-webkit-details-marker {
    display: none;
  }
  .userbar__menu summary:focus-visible {
    outline: 2px solid color-mix(in oklab, var(--color-accent), white 40%);
    outline-offset: 2px;
  }

  .userbar__menu[open] .userbar__avatar {
    box-shadow:
      var(--shadow-m),
      0 0 0 1px var(--color-border-primary) inset;
  }

  .userbar__menu-panel {
    position: absolute;
    top: calc(100% + 2px);
    right: 0;
    background: var(--color-bg-primary);
    color: var(--color-text-primary);
    border: 1px solid var(--color-border-primary);
    border-radius: var(--radius-m);
    box-shadow: var(--shadow-l);
    min-width: 160px;
    padding: 6px;
    z-index: 20;
  }

  .userbar__menu-item {
    display: block;
    padding: 8px 10px;
    border-radius: var(--radius-m);
    color: var(--color-text-primary);
    text-decoration: none;
    font-size: var(--font-size-s);
    transition:
      background-color var(--transition-base) var(--transition-easing-standard),
      color var(--transition-base) var(--transition-easing-standard),
      opacity var(--transition-fast) var(--transition-easing-standard);
  }
  .userbar__menu-item:hover {
    background: var(--color-bg-secondary);
    color: var(--color-text-primary);
  }
  .userbar__menu-item:focus-visible {
    outline: 2px solid color-mix(in oklab, var(--color-accent), white 40%);
    outline-offset: 2px;
  }

  @media (max-width: 640px) {
    .userbar {
      align-items: flex-start;
      padding: var(--space-xs) var(--space-s);
    }
    .userbar__greeting {
      font-size: 13px;
    }
  }
}
